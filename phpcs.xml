<?xml version="1.0"?>
<ruleset name="My Project">
    <description>WordPress Coding Standards for Obfuscated Malware Scanner</description>
    <file>includes/</file>
    <file>admin/</file>
    <file>obfuscated-malware-scanner.php</file>
    <file>tests/</file>
    <exclude-pattern>vendor/*</exclude-pattern>
    <exclude-pattern>wordpress/*</exclude-pattern>
    <exclude-pattern>.github/*</exclude-pattern>
    <exclude-pattern>src/*</exclude-pattern>
    <config name="testVersion" value="8.4-"/>
    <rule ref="WordPress"/>
    <!-- Allow class-file-security-policy.php naming (legacy compatibility) -->
    <rule ref="WordPress.Files.FileName">
        <exclude name="WordPress.Files.FileName.InvalidClassFileName"/>
    </rule>
    <!-- 
        Modern WordPress development (6.9+) supports PSR-4 namespaced classes.
        Namespaced classes in Services/, Core/, Providers/, Admin/, Interfaces/ 
        follow PSR-4 naming (PascalCase filenames matching class names).
        Non-namespaced classes must follow WordPress conventions (lowercase-hyphenated).
    -->
    <rule ref="WordPress.Files.FileName.NotHyphenatedLowercase">
        <exclude-pattern>includes/Services/*</exclude-pattern>
        <exclude-pattern>includes/Core/*</exclude-pattern>
        <exclude-pattern>includes/Providers/*</exclude-pattern>
        <exclude-pattern>includes/Admin/*</exclude-pattern>
        <exclude-pattern>includes/Interfaces/*</exclude-pattern>
    </rule>
    <!-- 
        Note: All coding standards violations in production code should be fixed
        with inline phpcs:ignore comments and proper justifications, not blanket exceptions.
        Test files are excluded below as they follow PHPUnit conventions.
    -->

    <!-- Test files follow PHPUnit conventions, not WordPress conventions -->
    <!-- Allow CamelCase filenames for PHPUnit test classes -->
    <rule ref="WordPress.Files.FileName.NotHyphenatedLowercase">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Allow camelCase method names for PHPUnit tests -->
    <rule ref="WordPress.NamingConventions.ValidFunctionName.MethodNameInvalid">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Test mocks may have unused parameters -->
    <rule ref="Generic.CodeAnalysis.UnusedFunctionParameter">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Test files don't need full doc comments -->
    <rule ref="Squiz.Commenting.FileComment.Missing">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <rule ref="Squiz.Commenting.FunctionComment.Missing">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <rule ref="Squiz.Commenting.VariableComment.Missing">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <rule ref="Squiz.Commenting.ClassComment.Missing">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Allow direct file operations in tests for setup/teardown -->
    <rule ref="WordPress.WP.AlternativeFunctions">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Allow date() in test mocks -->
    <rule ref="WordPress.DateTime.RestrictedFunctions.date_date">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Inline comment punctuation not required in tests -->
    <rule ref="Squiz.Commenting.InlineComment.InvalidEndChar">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Allow camelCase variables in tests (PHPUnit convention) -->
    <rule ref="WordPress.NamingConventions.ValidVariableName.VariableNotSnakeCase">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <rule ref="WordPress.NamingConventions.ValidVariableName.PropertyNotSnakeCase">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <rule ref="WordPress.NamingConventions.ValidVariableName.UsedPropertyNotSnakeCase">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Allow reserved keywords as parameter names in mock functions -->
    <rule ref="Universal.NamingConventions.NoReservedKeywordParameterNames">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Tests don't need output escaping -->
    <rule ref="WordPress.Security.EscapeOutput">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Tests don't need strict doc comment formatting -->
    <rule ref="Squiz.Commenting.FunctionComment.MissingParamComment">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <rule ref="Squiz.Commenting.FunctionComment.ParamCommentFullStop">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <rule ref="Squiz.Commenting.FunctionComment.ThrowsNoFullStop">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <rule ref="Squiz.Commenting.FunctionComment.EmptyThrows">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <rule ref="Generic.Commenting.DocComment.MissingShort">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Allow // style class comments in Codeception support files -->
    <rule ref="Squiz.Commenting.ClassComment.WrongStyle">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Multiple classes allowed in test files -->
    <rule ref="Generic.Files.OneObjectStructurePerFile">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Override detection not needed in tests -->
    <rule ref="Generic.CodeAnalysis.UselessOverridingMethod">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Mock classes may need to match external naming conventions (e.g., wpdb) -->
    <rule ref="PEAR.NamingConventions.ValidClassName.StartWithCapital">
        <exclude-pattern>tests/mocks/*</exclude-pattern>
    </rule>
    <!-- Mock files may mix functions and classes intentionally -->
    <rule ref="Universal.Files.SeparateFunctionsFromOO">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
    <!-- Tests may redefine classes for mocking purposes -->
    <rule ref="Generic.Classes.DuplicateClassName">
        <exclude-pattern>tests/*</exclude-pattern>
    </rule>
</ruleset>
